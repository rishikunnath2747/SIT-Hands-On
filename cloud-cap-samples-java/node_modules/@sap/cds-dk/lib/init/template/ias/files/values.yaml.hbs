{{#hasMultitenancy}}
sidecar:
    bindings:
        auth:
            serviceInstanceName: identity
            parameters:
                credential-type: X509_GENERATED
                app-identifier: mtx
{{/hasMultitenancy}}
{{#hasApprouter}}
approuter:
    bindings:
        auth:
            serviceInstanceName: identity
            parameters:
                credential-type: X509_GENERATED
                app-identifier: approuter
{{/hasApprouter}}
srv:
    bindings:
        auth:
            serviceInstanceName: identity
            parameters:
                credential-type: X509_GENERATED
                app-identifier: srv

identity:
    serviceOfferingName: identity
    servicePlanName: application
    parameters:
        display-name: {{appName}}
        {{#hasAms}}
        authorization:
            enabled: true
        {{/hasAms}}
        {{#hasMultitenancy}}
        multi-tenant: true
        {{/hasMultitenancy}}
        {{#hasXsuaa}}
        xsuaa-cross-consumption: true
        {{/hasXsuaa}}
        {{#hasApprouter}}
        oauth2-configuration:
            redirect-uris:
                {{=<% %>=}}
                - https://*.{{ tpl .Values.global.domain . }}/login/callback
                <%={{ }}=%>
            post-logout-redirect-uris:
                {{=<% %>=}}
                - https://*.{{ tpl .Values.global.domain . }}/*/logout.html
                <%={{ }}=%>
        {{/hasApprouter}}
